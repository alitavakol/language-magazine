<!DOCTYPE html>
<html>
	<head>
		<title>News Stories</title>
		<meta charset="utf-8">

		<link rel="stylesheet" type="text/css" href="../styles.css">

		<style id="dynamic-rules">
		</style>

		<style id="local-rules">
		</style>

		<style type="text/css">
			.free-wall {
				margin: 15px;
			}
		</style>

		<script src="file:///android_asset/jquery-1.11.3.min.js"></script>
		<script src="../../../jquery-1.11.3.min.js"></script>
		<script src="swipe.modified.js"></script>
		<script src="file:///android_asset/tinycolor-min.js"></script>
		<script src="../../../tinycolor-min.js"></script>
		<script src="freewall.js"></script>
		<script src="jquery-ui.min.js"></script>
		<script src="jquery.ui.touch-punch.min.js"></script>

		<script src="../code.js"></script>
	</head>

	<body>
		<div id="page-indicator">
			<span class="dot"></span>
			<span class="dot"></span>
		</div>

		<div id='swipeable' style='margin:0 auto;' class='swipe'>
			<div class='swipe-wrap'>
				<div>
					<div id="pre-reading" class="container">
						<div id="label-container">
							<h4>Match each form of transport with its corresponding picture. Drag names and drop them into correct pictures.</h4>
							<ul style="padding: 10px;" />
						</div>

						<div id="freewall" class="free-wall"></div>
						<h4>Now swipe right, and listen to the article. Then read transcript to verify your listening skills. ➜</h4>
					</div>
				</div>

				<div>
					<div class="poster hidden"></div>

					<div class="container">
						<h1>Train Anger</h1>
						<h3>A doctor gets angry on a train.</h3>

				 		<div class="transcript hidden">
							<p><span data-start="14428" data-end="23390">A doctor was on a train. He ordered some food. But when the food came, he got very angry. Why?</span></p>
							<p><span data-start="23391" data-end="28805">Dr Russell Walshaw was on a train. He was travelling to London.</span> <span data-start="28806" data-end="33810">At the time of the incident, he was in the first class <a class="new-word" data-word="a dining carriage" data-type="n" data-en="a special car/carriage in a train where people eat and there is a restaurant" data-fa="واگن اختصاصی به عنوان رستوران">dining carriage</a>.</span> <span data-start="33811" data-end="39440">The 66-year-old doctor was sitting there when a <a class="new-word" data-word="a steward" data-type="n" data-en="a person who works on a train/airplane serving food, helping passengers, etc" data-fa="خدمت‌کار قطار یا هواپیما">steward</a> came to talk to him.</span> <span data-start="39441" data-end="42619">The steward wanted to prepare the tables for lunch.</span> <span data-start="42620" data-end="47320">So, he asked the doctor <a class="new-word" data-word="politely" data-type="adv" data-en="with respect; considerately; not rudely" data-fa="محترمانه">politely</a>, “Would you mind moving, please?”</span> <span data-start="47321" data-end="54988">However, the doctor didn’t want to move. He had just finished eating breakfast and he was working on his <a class="new-word" data-word="a laptop" data-type="n" data-en="a small, portable computer that opens and closes like a book" data-fa="لپ‌تاپ">laptop</a>.</span> <span data-start="54989" data-end="58988">“You can <a class="new-word" data-word="to lay the table" data-type="exp" data-en="to prepare a table for eating: to put plates, glasses, forks, knives, etc on it" data-fa="چیدن و آماده کردن میز غذاخوری">lay the table</a> around me,” the doctor said.</span></p>
							<p><span data-start="58989" data-end="63590">The doctor continued working until the steward came back to lay the table.</span> <span data-start="63591" data-end="66210">But then the problems started.</span> <span data-start="66211" data-end="72540">“The steward put the <a class="new-word" data-word="a plate" data-type="n" data-en="a round, flat ceramic object on which you put food to eat" data-fa="بشقاب">plate</a> down on the table very <a class="new-word" data-word="forcefully" data-type="adv" data-en="with a lot of force" data-fa="با فشار">forcefully</a>,” the doctor explained.</span> <span data-start="72541" data-end="79643">“I shouted at the steward. But he just walked away. I was so angry that I threw a plate.”</span></p>
							<p><span data-start="79644" data-end="86020">The doctor was given a <a class="new-word" data-word="a warning" data-type="n" data-en="if you give someone a “warning”, you tell them of a possible danger in the future" data-fa="هشدار نسبت به خطر پیش رو">warning</a> from the General Medical Council in London (The GMC).</span> <span data-start="86021" data-end="90049">They said that the doctor’s actions were “unacceptable”.</span> <span data-start="90050" data-end="95733">In his defence, the doctor said that he had been responding to the steward’s aggression.</span> <span data-start="95734" data-end="102400">“The steward <a class="new-word" data-word="to drop" data-type="vb" data-en="to let something fall from your hands; if something “drops”, it falls accidentally" data-fa="ناگهان انداختن">dropped</a> the plate on my table and showed <a class="new-word" data-word="bad manners" data-type="exp" data-en="if you have “bad manners”, you are not polite to someone; you say/do rude things" data-fa="اخلاق بد و نا ملایم">bad manners</a>,” the doctor explained.</span> <span data-start="102401" data-end="114800">“Also, I didn’t throw the plate at him, I threw the plate in his general direction. I’m sorry that it hit him. Perhaps I should have just shouted at him instead.”</span> <span class="accent"> ★</span></p>
						</div>
					</div>
				</div>
			</div>
		</div>

		<script type="text/javascript">
			var pics = ['balloon', 'bus', 'train', 'helicopter', 'motorbike', 'bicycle', 'ship', 'car'];
			var mix = [2,5,1,7,0,6,4,3];
			var baseWidth = $(window).width() / 8;
			var widths = [6, 4, 6, 4, 2, 2, 6, 4];
			var temp = "<div class='brick rounded-corners droppable' data-label='{index}' style='width: {width}px;'><img src='{index}.jpg' width='100%'></div>";
			var temp2 = "<li class='label draggable'>{index}</li>";
			var html = '', html2 = '';
			for (var i = 0; i < 8; ++i) {
				html += temp.replace(/\{width\}/g, widths[i] * baseWidth).replace(/\{index\}/g, pics[i]);
				html2 += temp2.replace(/\{index\}/g, pics[mix[i]]);
			}
			$("#freewall").html(html);
			$("#label-container > ul").html(html2);

			var wall = new Freewall("#freewall");
			wall.reset({
				selector: '.brick',
				animate: true,
				cellW: baseWidth*2,
				cellH: 'auto',
				onResize: function() {
					wall.fitWidth();
				}
			});

			var images = wall.container.find('.brick');
			images.find('img').load(function() {
				wall.fitWidth();
			});


			$('.draggable').draggable({
				scroll: true,
				stack: '#freewall',
				revert: true,
				revertDuration: 0,
				scrollSpeed: 10,
				containment: '#pre-reading',
				start: function(ev, ui) {
					disableSwipe = true;
				},
				stop: function(ev, ui) {
					disableSwipe = false;
				},
			});
			$('.droppable').droppable({
				activate: function(ev, ui) {
				},
				deactivate: function(ev, ui) {
				},
				drop: function( event, ui ) {
					if($(this).data('label') == ui.draggable.html()) {
						$(this).append(ui.draggable.remove().css('position', '').addClass('attached'));
						if(typeof(app) != 'undefined')
							app.makeToast('Yes!', false);
					} else {
						if(typeof(app) != 'undefined')
							app.makeToast('That\'s not right.', false);
					}
				}
			});
			$(".draggable").mousedown(function(e){ e.stopPropagation();return false;});

			adjustCustomLayout = function(options) {
				t = "(#" + backgroundColor + ", " + tinycolor(backgroundColor).setAlpha(0).toRgbString() + ", #" + backgroundColor + "), url('angry-doctor.jpg')";
				$('#local-rules').text("\
					#label-container { background-color: #" + backgroundColor + "; } \
					.label { background-color: #" + accentColor + "; } \
					.poster { background-image: -webkit-linear-gradient" + t + "; background-image: linear-gradient" + t + "; height: " + height + "px; } "
				);
			}

			lock = function(b) {
				transcriptLocked = b;

				if(b) {
					$('.transcript').addClass('hidden');
					$('.poster').removeClass('hidden');
					$('h1').removeClass('alt');
					$('h3').removeClass('alt');

				} else {
					$('.transcript').removeClass('hidden');
					$('.poster').addClass('hidden');
					$('h1').eq(1).addClass('alt');
					$('h3').eq(1).addClass('alt');
				}

				if(typeof(app) != 'undefined') {
					saveInstanceState();
				}
			}

			setCurrentSlide = function(index) {
				$('#page-indicator').show();
				$('#page-indicator .dot').eq(index).addClass('active');

				if(typeof(swipeable) == 'object' && typeof(swipeable.kill) == 'function')
					swipeable.kill();

				swipeable = $('#swipeable').Swipe({
					startSlide: index,
					stopPropagation: true,
					continuous: false,
					callback: function(index,elem) {
						currentSlide = index;

						$('#page-indicator .dot').removeClass('active');
						$('#page-indicator .dot').eq(index).addClass('active');

						if(typeof(app) != 'undefined')
							app.showLockControls(currentSlide == 1);
						saveInstanceState();
					},
				}).data('Swipe');				
			}

			saveInstanceState = function() {
				outState = {
					currentSlide: currentSlide,
					transcriptLocked: transcriptLocked,
				};

				if(typeof(app) != 'undefined')
					app.saveInstanceState(JSON.stringify(outState));
			}

			restoreInstanceState = function(savedInstanceState) {
				state = JSON.parse(savedInstanceState);

				setCurrentSlide(state.currentSlide);
				lock(state.transcriptLocked);
			}

			setCurrentSlide(0);
			lock(true);
		</script>

	</body>
</html>
